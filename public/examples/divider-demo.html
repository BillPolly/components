<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Divider Component Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8fafc;
            line-height: 1.6;
        }
        
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .demo-header {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .demo-header h1 {
            margin: 0 0 8px 0;
            color: #1f2937;
        }
        
        .demo-header p {
            margin: 0;
            color: #6b7280;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .demo-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .demo-section-header {
            background: #f8fafc;
            padding: 16px 24px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .demo-section-title {
            font-weight: 600;
            color: #1f2937;
            margin: 0;
        }
        
        .demo-section-content {
            padding: 24px;
        }
        
        .demo-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .demo-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .demo-button:hover {
            background: #2563eb;
        }
        
        .demo-button.secondary {
            background: #6b7280;
        }
        
        .demo-button.secondary:hover {
            background: #4b5563;
        }
        
        .demo-button.danger {
            background: #ef4444;
        }
        
        .demo-button.danger:hover {
            background: #dc2626;
        }
        
        .demo-input {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            width: 100px;
            margin-right: 8px;
        }
        
        .demo-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .demo-divider-container {
            height: 300px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            background: #ffffff;
        }
        
        .demo-pane {
            position: absolute;
            background: #f8fafc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            color: #374151;
            border: 2px dashed #d1d5db;
        }
        
        .demo-pane.left {
            left: 0;
            top: 0;
            bottom: 0;
        }
        
        .demo-pane.right {
            right: 0;
            top: 0;
            bottom: 0;
        }
        
        .demo-pane.top {
            left: 0;
            right: 0;
            top: 0;
        }
        
        .demo-pane.bottom {
            left: 0;
            right: 0;
            bottom: 0;
        }
        
        .demo-status {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            color: #0c4a6e;
            padding: 12px 16px;
            border-radius: 6px;
            margin-top: 12px;
            font-size: 14px;
        }
        
        .demo-code {
            background: #1f2937;
            color: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.4;
            margin-top: 16px;
        }
        
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .theme-toggle input[type="checkbox"] {
            margin: 0;
        }
        
        .position-display {
            background: #f8fafc;
            padding: 8px 12px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
            color: #374151;
            min-width: 60px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>Divider Component Demo</h1>
            <p>Interactive demonstration of the umbilical Divider component with drag-to-resize, programmatic control, and both vertical and horizontal orientations.</p>
        </div>

        <div class="demo-grid">
            <!-- Vertical Divider Demo -->
            <div class="demo-section">
                <div class="demo-section-header">
                    <h3 class="demo-section-title">Vertical Divider</h3>
                    <div class="theme-toggle">
                        <label>
                            <input type="checkbox" id="vertical-theme-toggle"> Dark Theme
                        </label>
                    </div>
                </div>
                <div class="demo-section-content">
                    <div class="demo-controls">
                        <label>Position: <input type="number" id="vertical-position" class="demo-input" value="50" min="10" max="90" style="width: 80px;"></label>
                        <button class="demo-button secondary" onclick="toggleVerticalLock()">Toggle Lock</button>
                        <button class="demo-button secondary" onclick="toggleVerticalEnabled()">Toggle Enable</button>
                        <div class="position-display" id="vertical-current">50%</div>
                    </div>
                    <div id="vertical-divider" class="demo-divider-container">
                        <div class="demo-pane left" id="vertical-left">
                            <div id="left-image-viewer" style="width: 100%; height: 100%;"></div>
                        </div>
                        <div class="demo-pane right" id="vertical-right">Right Pane</div>
                    </div>
                    <div id="vertical-status" class="demo-status">Left pane: aspect ratio LOCKED (maintains proportions). Right pane: regular content. Drag divider to resize!</div>
                </div>
            </div>

            <!-- Horizontal Divider Demo -->
            <div class="demo-section">
                <div class="demo-section-header">
                    <h3 class="demo-section-title">Horizontal Divider</h3>
                </div>
                <div class="demo-section-content">
                    <div class="demo-controls">
                        <label>Position: <input type="number" id="horizontal-position" class="demo-input" value="40" min="10" max="90" style="width: 80px;"></label>
                        <button class="demo-button secondary" onclick="toggleHorizontalLock()">Toggle Lock</button>
                        <button class="demo-button secondary" onclick="toggleHorizontalEnabled()">Toggle Enable</button>
                        <div class="position-display" id="horizontal-current">40%</div>
                    </div>
                    <div id="horizontal-divider" class="demo-divider-container">
                        <div class="demo-pane top" id="horizontal-top">
                            <div id="top-image-viewer" style="width: 100%; height: 100%;"></div>
                        </div>
                        <div class="demo-pane bottom" id="horizontal-bottom">Bottom Pane</div>
                    </div>
                    <div id="horizontal-status" class="demo-status">Top pane: aspect ratio UNLOCKED (stretches to fill). Bottom pane: regular content. Horizontal divider with bounds (10% - 90%).</div>
                </div>
            </div>
        </div>

        <!-- Advanced Controls Demo -->
        <div class="demo-section">
            <div class="demo-section-header">
                <h3 class="demo-section-title">Advanced Controls & Bounds</h3>
            </div>
            <div class="demo-section-content">
                <div class="demo-controls">
                    <label>Min: <input type="number" id="bounds-min" class="demo-input" value="20" min="0" max="100" style="width: 60px;"></label>
                    <label>Max: <input type="number" id="bounds-max" class="demo-input" value="80" min="0" max="100" style="width: 60px;"></label>
                    <button class="demo-button" onclick="setBounds()">Set Bounds</button>
                    <button class="demo-button secondary" onclick="resetBounds()">Reset Bounds</button>
                    <button class="demo-button danger" onclick="destroyAdvanced()">Destroy</button>
                    <button class="demo-button" onclick="recreateAdvanced()">Recreate</button>
                    <div class="position-display" id="advanced-current">50%</div>
                </div>
                <div id="advanced-divider" class="demo-divider-container">
                    <div class="demo-pane left" id="advanced-left">Constrained Left</div>
                    <div class="demo-pane right" id="advanced-right">Constrained Right</div>
                </div>
                <div id="advanced-status" class="demo-status">This divider has custom bounds (20% - 80%). Try changing the bounds and see how it constrains the divider movement.</div>
            </div>
        </div>

        <!-- Code Example -->
        <div class="demo-section">
            <div class="demo-section-header">
                <h3 class="demo-section-title">Usage Example</h3>
            </div>
            <div class="demo-section-content">
                <pre class="demo-code">// Create a vertical divider
const verticalDivider = Divider.create({
  dom: document.getElementById('container'),
  orientation: 'vertical',
  initialPosition: 50,
  minPosition: 20,
  maxPosition: 80,
  theme: 'light',
  onResize: (position, instance) => {
    console.log('Divider moved to:', position + '%');
    updateLayout(position);
  },
  onDragStart: (position) => {
    console.log('Started dragging at:', position + '%');
  },
  onDragEnd: (position) => {
    console.log('Finished dragging at:', position + '%');
  }
});

// Programmatic control
verticalDivider.setPosition(75);
verticalDivider.lock();
verticalDivider.setBounds(10, 90);

// Create a horizontal divider
const horizontalDivider = Divider.create({
  dom: document.getElementById('container2'),
  orientation: 'horizontal',
  initialPosition: 40,
  thickness: 6
});

// State management
console.log('Position:', horizontalDivider.position);
console.log('Locked:', horizontalDivider.locked);
console.log('Enabled:', horizontalDivider.enabled);</pre>
            </div>
        </div>
    </div>

    <script type="module">
        import { Divider } from '/src/components/divider/index.js';
        import { SimpleImage } from '/src/components/simple-image/index.js';

        // Divider instances
        let verticalDivider, horizontalDivider, advancedDivider;
        
        // Simple image instances
        let leftImage, topImage;

        // Helper function to update pane sizes
        function updatePanes(container, position, orientation) {
            const leftPane = container.querySelector('.demo-pane.left, .demo-pane.top');
            const rightPane = container.querySelector('.demo-pane.right, .demo-pane.bottom');
            
            if (orientation === 'vertical') {
                leftPane.style.width = position + '%';
                rightPane.style.width = (100 - position) + '%';
                rightPane.style.left = position + '%';
            } else {
                leftPane.style.height = position + '%';
                rightPane.style.height = (100 - position) + '%';
                rightPane.style.top = position + '%';
            }
        }

        // Helper function to update status
        function updateStatus(elementId, message) {
            document.getElementById(elementId).textContent = message;
        }

        // Initialize simple images
        function initImageViewers() {
            // Left pane: Aspect ratio LOCKED (maintains proportions)
            // Try with a fallback data URL if external image fails
            const leftImageSrc = 'data:image/svg+xml,' + encodeURIComponent(`
                <svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#ff7e5f;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#feb47b;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <rect width="100%" height="100%" fill="url(#grad1)"/>
                    <text x="400" y="280" text-anchor="middle" fill="white" font-family="Arial" font-size="32" font-weight="bold">
                        ASPECT LOCKED
                    </text>
                    <text x="400" y="320" text-anchor="middle" fill="white" font-family="Arial" font-size="20">
                        (maintains proportions)
                    </text>
                    <text x="400" y="360" text-anchor="middle" fill="white" font-family="Arial" font-size="16">
                        800 × 600 image
                    </text>
                </svg>
            `);
            
            leftImage = SimpleImage.create({
                dom: document.getElementById('left-image-viewer'),
                src: leftImageSrc,
                alt: 'Aspect ratio locked demo',
                objectFit: 'contain', // LOCKED - maintains aspect ratio
                onLoad: () => {
                    console.log('Left image loaded successfully');
                    updateStatus('vertical-status', 'Left: aspect ratio LOCKED (maintains proportions). Drag divider to resize!');
                },
                onError: () => {
                    console.log('Left image failed to load');
                    updateStatus('vertical-status', 'Left: Failed to load image.');
                }
            });

            // Top pane: Aspect ratio UNLOCKED (stretches to fill)
            const topImageSrc = 'data:image/svg+xml,' + encodeURIComponent(`
                <svg width="900" height="300" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <rect width="100%" height="100%" fill="url(#grad2)"/>
                    <text x="450" y="140" text-anchor="middle" fill="white" font-family="Arial" font-size="32" font-weight="bold">
                        ASPECT UNLOCKED
                    </text>
                    <text x="450" y="180" text-anchor="middle" fill="white" font-family="Arial" font-size="20">
                        (stretches to fill)
                    </text>
                    <text x="450" y="220" text-anchor="middle" fill="white" font-family="Arial" font-size="16">
                        900 × 300 image
                    </text>
                </svg>
            `);
            
            topImage = SimpleImage.create({
                dom: document.getElementById('top-image-viewer'),
                src: topImageSrc,
                alt: 'Aspect ratio unlocked demo',
                objectFit: 'fill', // UNLOCKED - stretches to fill container
                onLoad: () => {
                    console.log('Top image loaded successfully');
                    updateStatus('horizontal-status', 'Top: aspect ratio UNLOCKED (stretches to fill). Try horizontal divider!');
                },
                onError: () => {
                    console.log('Top image failed to load');
                    updateStatus('horizontal-status', 'Top: Failed to load image.');
                }
            });
        }

        // Initialize dividers
        function initDividers() {
            // Vertical divider
            verticalDivider = Divider.create({
                dom: document.getElementById('vertical-divider'),
                orientation: 'vertical',
                initialPosition: 50,
                theme: 'light',
                onResize: (position, instance) => {
                    updatePanes(document.getElementById('vertical-divider'), position, 'vertical');
                    document.getElementById('vertical-current').textContent = Math.round(position) + '%';
                    document.getElementById('vertical-position').value = Math.round(position); // Update input value
                    updateStatus('vertical-status', `Divider at ${Math.round(position)}% - ${instance.locked ? 'LOCKED' : 'unlocked'} - ${instance.enabled ? 'enabled' : 'DISABLED'}`);
                },
                onDragStart: (position) => {
                    updateStatus('vertical-status', `Started dragging at ${Math.round(position)}%`);
                },
                onDragEnd: (position) => {
                    updateStatus('vertical-status', `Finished dragging at ${Math.round(position)}%`);
                }
            });

            // Initialize vertical panes
            updatePanes(document.getElementById('vertical-divider'), 50, 'vertical');

            // Horizontal divider
            horizontalDivider = Divider.create({
                dom: document.getElementById('horizontal-divider'),
                orientation: 'horizontal',
                initialPosition: 40,
                minPosition: 10,
                maxPosition: 90,
                thickness: 6,
                onResize: (position, instance) => {
                    updatePanes(document.getElementById('horizontal-divider'), position, 'horizontal');
                    document.getElementById('horizontal-current').textContent = Math.round(position) + '%';
                    document.getElementById('horizontal-position').value = Math.round(position); // Update input value
                    updateStatus('horizontal-status', `Horizontal divider at ${Math.round(position)}% - bounds: ${instance.getBounds().min}% to ${instance.getBounds().max}%`);
                }
            });

            // Initialize horizontal panes
            updatePanes(document.getElementById('horizontal-divider'), 40, 'horizontal');

            // Advanced divider
            advancedDivider = Divider.create({
                dom: document.getElementById('advanced-divider'),
                orientation: 'vertical',
                initialPosition: 50,
                minPosition: 20,
                maxPosition: 80,
                onResize: (position, instance) => {
                    updatePanes(document.getElementById('advanced-divider'), position, 'vertical');
                    document.getElementById('advanced-current').textContent = Math.round(position) + '%';
                    const bounds = instance.getBounds();
                    updateStatus('advanced-status', `Position: ${Math.round(position)}% (bounds: ${bounds.min}% - ${bounds.max}%)`);
                }
            });

            // Initialize advanced panes
            updatePanes(document.getElementById('advanced-divider'), 50, 'vertical');

            // Theme toggle
            const themeToggle = document.getElementById('vertical-theme-toggle');
            themeToggle.addEventListener('change', (e) => {
                const theme = e.target.checked ? 'dark' : 'light';
                verticalDivider.setTheme(theme);
                updateStatus('vertical-status', `Theme changed to ${theme}`);
            });
        }

        // Control functions for vertical divider

        window.toggleVerticalLock = () => {
            if (verticalDivider.locked) {
                verticalDivider.unlock();
                updateStatus('vertical-status', 'Divider unlocked');
            } else {
                verticalDivider.lock();
                updateStatus('vertical-status', 'Divider locked');
            }
        };

        window.toggleVerticalEnabled = () => {
            if (verticalDivider.enabled) {
                verticalDivider.disable();
                updateStatus('vertical-status', 'Divider disabled');
            } else {
                verticalDivider.enable();
                updateStatus('vertical-status', 'Divider enabled');
            }
        };

        // Control functions for horizontal divider

        window.toggleHorizontalLock = () => {
            if (horizontalDivider.locked) {
                horizontalDivider.unlock();
                updateStatus('horizontal-status', 'Horizontal divider unlocked');
            } else {
                horizontalDivider.lock();
                updateStatus('horizontal-status', 'Horizontal divider locked');
            }
        };

        window.toggleHorizontalEnabled = () => {
            if (horizontalDivider.enabled) {
                horizontalDivider.disable();
                updateStatus('horizontal-status', 'Horizontal divider disabled');
            } else {
                horizontalDivider.enable();
                updateStatus('horizontal-status', 'Horizontal divider enabled');
            }
        };

        // Control functions for advanced divider
        window.setBounds = () => {
            const min = parseInt(document.getElementById('bounds-min').value);
            const max = parseInt(document.getElementById('bounds-max').value);
            
            if (min >= max) {
                updateStatus('advanced-status', 'Error: Min bound must be less than max bound');
                return;
            }
            
            try {
                advancedDivider.setBounds(min, max);
                updateStatus('advanced-status', `Bounds set to ${min}% - ${max}%`);
            } catch (error) {
                updateStatus('advanced-status', `Error: ${error.message}`);
            }
        };

        window.resetBounds = () => {
            advancedDivider.setBounds(10, 90);
            document.getElementById('bounds-min').value = 10;
            document.getElementById('bounds-max').value = 90;
            updateStatus('advanced-status', 'Bounds reset to 10% - 90%');
        };

        window.destroyAdvanced = () => {
            if (advancedDivider) {
                advancedDivider.destroy();
                advancedDivider = null;
                updateStatus('advanced-status', 'Advanced divider destroyed');
            }
        };

        window.recreateAdvanced = () => {
            if (!advancedDivider) {
                advancedDivider = Divider.create({
                    dom: document.getElementById('advanced-divider'),
                    orientation: 'vertical',
                    initialPosition: 50,
                    minPosition: 20,
                    maxPosition: 80,
                    onResize: (position, instance) => {
                        updatePanes(document.getElementById('advanced-divider'), position, 'vertical');
                        document.getElementById('advanced-current').textContent = Math.round(position) + '%';
                        const bounds = instance.getBounds();
                        updateStatus('advanced-status', `Position: ${Math.round(position)}% (bounds: ${bounds.min}% - ${bounds.max}%)`);
                    }
                });
                updatePanes(document.getElementById('advanced-divider'), 50, 'vertical');
                updateStatus('advanced-status', 'Advanced divider recreated');
            }
        };

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            initImageViewers();
            initDividers();
            
            // Setup real-time position controls
            const verticalPositionInput = document.getElementById('vertical-position');
            const horizontalPositionInput = document.getElementById('horizontal-position');
            
            // Vertical position real-time update
            verticalPositionInput.addEventListener('input', (e) => {
                const position = parseInt(e.target.value);
                if (!isNaN(position) && position >= 10 && position <= 90) {
                    if (verticalDivider.setPosition(position)) {
                        updateStatus('vertical-status', `Position changed to ${position}% via input`);
                    }
                }
            });
            
            // Horizontal position real-time update
            horizontalPositionInput.addEventListener('input', (e) => {
                const position = parseInt(e.target.value);
                if (!isNaN(position) && position >= 10 && position <= 90) {
                    if (horizontalDivider.setPosition(position)) {
                        updateStatus('horizontal-status', `Position changed to ${position}% via input`);
                    }
                }
            });
            
            // Also update on keydown for arrow keys and other key navigation
            verticalPositionInput.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                    setTimeout(() => {
                        const position = parseInt(e.target.value);
                        if (!isNaN(position) && position >= 10 && position <= 90) {
                            verticalDivider.setPosition(position);
                        }
                    }, 10);
                }
            });
            
            horizontalPositionInput.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                    setTimeout(() => {
                        const position = parseInt(e.target.value);
                        if (!isNaN(position) && position >= 10 && position <= 90) {
                            horizontalDivider.setPosition(position);
                        }
                    }, 10);
                }
            });

            // Theme toggle
            const themeToggle = document.getElementById('vertical-theme-toggle');
            themeToggle.addEventListener('change', (e) => {
                const theme = e.target.checked ? 'dark' : 'light';
                verticalDivider.setTheme(theme);
                updateStatus('vertical-status', `Theme changed to ${theme}`);
            });
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (verticalDivider) verticalDivider.destroy();
            if (horizontalDivider) horizontalDivider.destroy();
            if (advancedDivider) advancedDivider.destroy();
            if (leftImage) leftImage.destroy();
            if (topImage) topImage.destroy();
        });
    </script>
</body>
</html>