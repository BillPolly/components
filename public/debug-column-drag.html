<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Column Drag</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .grid-container {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }
        .debug-log {
            background: #1a1a1a;
            color: #00ff00;
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 20px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .clear-button {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            margin-bottom: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Debug Column Drag and Drop</h1>
        <button class="clear-button" onclick="clearLog()">Clear Log</button>
        <div id="debug-log" class="debug-log">Debug log will appear here...</div>
        <div id="grid-container" class="grid-container"></div>
    </div>

    <script type="module">
        import { Grid } from '/src/components/grid/index.js';

        const debugLog = document.getElementById('debug-log');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            debugLog.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            debugLog.scrollTop = debugLog.scrollHeight;
            console.log(message);
        }

        window.clearLog = () => {
            debugLog.innerHTML = '';
        };

        // Simple test data
        const testData = [
            { id: 1, name: 'Alice', dept: 'Eng', active: true },
            { id: 2, name: 'Bob', dept: 'Marketing', active: false },
            { id: 3, name: 'Carol', dept: 'Sales', active: true }
        ];

        const columns = [
            { key: 'name', label: 'Name', type: 'text', width: '150px' },
            { key: 'dept', label: 'Department', type: 'text', width: '120px' },
            { key: 'active', label: 'Active', type: 'boolean', width: '80px' }
        ];

        try {
            log('Creating grid with column dragging...');
            
            const grid = Grid.create({
                data: testData,
                columns: columns,
                mode: 'table',
                
                columnDragging: {
                    enabled: true,
                    onColumnDragStart: (columnKey, columnIndex) => {
                        log(`üöÄ DRAG START: Column ${columnKey} (index ${columnIndex})`);
                    },
                    onColumnDragOver: (sourceIndex, targetIndex) => {
                        log(`üëÜ DRAG OVER: Source ${sourceIndex} ‚Üí Target ${targetIndex}`);
                    },
                    onColumnDrop: (sourceIndex, targetIndex, newColumns) => {
                        log(`‚úÖ DROP SUCCESS: Column ${sourceIndex} ‚Üí Position ${targetIndex}`);
                        log(`üìù New order: ${newColumns.map(col => col.key).join(', ')}`);
                    }
                },
                
                dom: document.getElementById('grid-container')
            });
            
            log('‚úÖ Grid initialized! Try dragging column headers.');
            
        } catch (error) {
            log(`‚ùå Error: ${error.message}`);
            console.error('Grid initialization failed:', error);
        }
    </script>
</body>
</html>