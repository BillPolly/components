<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Grid Drag and Drop</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .grid-container {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }
        .status {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 20px;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Grid Drag and Drop Test</h1>
        <div id="status" class="status">Initializing grid...</div>
        <div id="grid-container" class="grid-container"></div>
    </div>

    <script type="module">
        import { Grid } from '/src/components/grid/index.js';

        const statusElement = document.getElementById('status');
        
        function updateStatus(message) {
            const timestamp = new Date().toLocaleTimeString();
            statusElement.textContent = `[${timestamp}] ${message}`;
        }

        // Test data
        const testData = [
            { id: 1, name: 'Alice Johnson', department: 'Engineering', active: true },
            { id: 2, name: 'Bob Smith', department: 'Marketing', active: true },
            { id: 3, name: 'Carol Davis', department: 'Sales', active: false },
            { id: 4, name: 'David Wilson', department: 'Engineering', active: true },
            { id: 5, name: 'Eva Brown', department: 'HR', active: true }
        ];

        const columns = [
            { key: 'name', label: 'Name', type: 'text', width: '200px' },
            { key: 'department', label: 'Department', type: 'text', width: '150px' },
            { key: 'active', label: 'Active', type: 'boolean', width: '100px' }
        ];

        try {
            updateStatus('Creating grid with drag and drop enabled...');
            
            const grid = Grid.create({
                data: testData,
                columns: columns,
                mode: 'table',
                
                // Enable row dragging with new implementation
                rowDragging: {
                    enabled: true,
                    onDragStart: (rowIndex, rowData) => {
                        updateStatus(`Started dragging row ${rowIndex + 1}: ${rowData.name}`);
                    },
                    onDragOver: (sourceIndex, targetIndex) => {
                        updateStatus(`Dragging row ${sourceIndex + 1} over row ${targetIndex + 1}`);
                    },
                    onDrop: (sourceIndex, targetIndex, newData) => {
                        updateStatus(`Dropped row ${sourceIndex + 1} at position ${targetIndex + 1}. Row reordered successfully!`);
                        console.log('New data order:', newData.map(row => row.name));
                    }
                },
                
                dom: document.getElementById('grid-container')
            });
            
            updateStatus('Grid initialized! Try dragging any row to reorder.');
            
        } catch (error) {
            updateStatus(`Error: ${error.message}`);
            console.error('Grid initialization failed:', error);
        }
    </script>
</body>
</html>